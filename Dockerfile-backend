FROM python:alpine

ADD . /code
COPY config.yaml.sample /config.yaml
RUN sed -i 's/host:.*/host: "db"/' /config.yaml
RUN sed -i 's/api: false/api: true/' /config.yaml
RUN sed -i 's/testing: false/testing: true/' /config.yaml
WORKDIR /code/backend

ENV PYTHONPATH /code/backend

RUN pip3 install -r requirements.txt

CMD ["python3", "app.py", "--config_file", "/config.yaml"]
